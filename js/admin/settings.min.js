jQuery.fn.currencyFormat=function(){return this.each(function(){var e=this.value.split(".");e[1]&&2<e[1].length?(e[1]=e[1].substring(0,2),this.value=parseFloat(e.join("."))):this.value=this.value}),this},jQuery(document).ready(function(c){var i={responder:{handle:c(".wp_weixin-responder-section.wp_weixin-responder-field input"),content:c(".wp_weixin-responder-section:not(.wp_weixin-responder-field)")},proxy:{handle:c(".wp_weixin-proxy-section.wp_weixin-proxy-field input"),content:c(".wp_weixin-proxy-section:not(.wp_weixin-proxy-field)")}},e=[c(".wp_weixin-follow_welcome-field input")];function t(){c.each(e,function(e,n){n.prop("checked")&&(i.responder.handle.prop("checked",!0),i.responder.content.show())})}c.each(i,function(e,n){n.handle.prop("checked")?n.content.show():n.content.hide(),n.handle.on("change",function(){c(this).prop("checked")?n.content.show():n.content.hide()})}),c.each(e,function(e,n){n.prop("checked")&&!i.responder.handle.prop("checked")&&(i.responder.handle.prop("checked",!0),i.responder.handle.trigger("change")),n.on("change",t)}),i.responder.handle.on("change",t),c(".wp_weixin-force_auth-field input").prop("checked")&&c(".wp_weixin-enable_auth-field input").prop("checked",!0),c(".wp_weixin-enable_auth-field input, .wp_weixin-force_auth-field input").on("change",function(){c(".wp_weixin-force_auth-field input").prop("checked")&&c(".wp_weixin-enable_auth-field input").prop("checked",!0)}),c("#wp_weixin_qr_amount").on("keyup",function(e){e.preventDefault(),c(this).currencyFormat()}),c(".qr-button").on("click",function(e){e.preventDefault();var n,i=c(this),t=c("#"+i.data("img")),o=c("#qr_url").val(),r=c("#wp_weixin_qr_amount").val(),p=c("#wp_weixin_qr_amount_fixed").prop("checked");(n=i.hasClass("qr-payment-button")?{amount:r,fixed:p,url:t.data("default_url")}:{url:o}).action="wp_weixin_get_qr",c.ajax({url:WpWeixin.ajax_url,type:"POST",data:n}).done(function(e){e.success?(t.attr("src",t.data("base_url")+e.data),t.css("visibility","visible"),t.parent().children("span").hide()):(t.css("visibility","hidden"),t.parent().children("span").show())}).fail(function(e,n){WpWeixin.debug&&window.console.log(n)})})});