jQuery.fn.currencyFormat=function(){return this.each(function(){var e=this.value.split(".");e[1]&&2<e[1].length?(e[1]=e[1].substring(0,2),this.value=parseFloat(e.join("."))):this.value=this.value}),this},jQuery(document).ready(function(a){var i={responder:{handle:a(".wp_weixin-responder-section.wp_weixin-responder-field input"),content:a(".wp_weixin-responder-section:not(.wp_weixin-responder-field)")},proxy:{handle:a(".wp_weixin-proxy-section.wp_weixin-proxy-field input"),content:a(".wp_weixin-proxy-section:not(.wp_weixin-proxy-field)")}},e=[a(".wp_weixin-follow_welcome-field input")];function t(){a.each(e,function(e,n){n.prop("checked")&&(i.responder.handle.prop("checked",!0),i.responder.content.show())})}a.each(i,function(e,n){n.handle.prop("checked")?n.content.show():n.content.hide(),n.handle.on("change",function(){a(this).prop("checked")?n.content.show():n.content.hide()})}),a.each(e,function(e,n){n.prop("checked")&&!i.responder.handle.prop("checked")&&(i.responder.handle.prop("checked",!0),i.responder.handle.trigger("change")),n.on("change",t)}),i.responder.handle.on("change",t),a(".wp_weixin-force_auth-field input").prop("checked")&&a(".wp_weixin-enable_auth-field input").prop("checked",!0),a(".wp_weixin-enable_auth-field input, .wp_weixin-force_auth-field input").on("change",function(){a(".wp_weixin-force_auth-field input").prop("checked")&&a(".wp_weixin-enable_auth-field input").prop("checked",!0)}),a("#wp_weixin_qr_amount").on("keyup",function(e){e.preventDefault(),a(this).currencyFormat()}),a(".qr-button").on("click",function(e){e.preventDefault();var n,i=a(this),t=a("#"+i.data("img")),o=a("#qr_url").val(),r=a("#wp_weixin_qr_amount").val(),p=a("#wp_weixin_qr_amount_fixed").prop("checked"),c=a("#wp_weixin_qr_product_name").val();(n=i.hasClass("qr-payment-button")?{amount:r,fixed:p,productName:c,url:t.data("default_url")}:{url:o}).action="wp_weixin_get_settings_qr",a.ajax({url:WpWeixin.ajax_url,type:"POST",data:n}).done(function(e){e.success?(t.attr("src",t.data("base_url")+e.data),t.css("visibility","visible"),t.parent().children("span").hide()):(t.css("visibility","hidden"),t.parent().children("span").show())}).fail(function(e,n){WpWeixin.debug&&window.console.log(n)})})});