jQuery(function(o){o(document).ready(function(){function i(){var e={nonce:o("#auth_qr_nonce").val(),action:"wp_weixin_get_auth_qr"},i=o(".auth-qr-code"),n=o("#auth_hash");o.ajax({url:WP_Weixin.ajax_url,type:"POST",data:e}).done(function(e){e.success?(i.attr("src",e.data.qrSrc),i.css("visibility","visible"),n.val(e.data.hash),o(".desktop-qr-content .message").show(),o(".waiting").show(),window.authListenerStart()):(i.css("visibility","hidden"),i.attr("src",""),n.val(""),window.authListenerStop())}).fail(function(e,i){WP_Weixin.debug&&window.console.log(i)})}o(".wechat-auth").length&&(i(),o(".refresh").on("click",function(e){e.preventDefault(),i()}),window.registerAuthScanSuccessListener(function(e){o(".waiting").hide(),o(".success").show(),WP_Weixin.debug&&console.log(e),e.redirect&&(o(".success .redirect-message").show(),setTimeout(function(){window.location=e.redirect},4e3))}),window.registerAuthScanFailureListener(function(e){o(".waiting").hide(),o(".failure").show(),o(".error").show(),o(".auth-qr-code").css("visibility","hidden"),o.each(e.error,function(e,i){o(".error").append("<br/>"+i+"<br/>")}),WP_Weixin.debug&&console.log(e),e.redirect&&(o(".failure .redirect-message").show(),setTimeout(function(){window.location=e.redirect},4e3))}),window.registerAuthBeatSuccessListener(function(e){o(".network-on").show(),o(".network-off").hide(),WP_Weixin.debug&&console.log(e)}),window.registerAuthBeatFailureListener(function(e){o(".network-on").hide(),o(".network-off").show(),WP_Weixin.debug&&console.log(e)}))}),window.wpWeixinShareTimelineSuccessTrigger=function(e){window.wpWeixinShareTimelineSuccess=new CustomEvent("wpWeixinShareTimelineSuccess",{detail:e}),window.dispatchEvent(window.wpWeixinShareTimelineSuccess)},window.wpWeixinShareTimelineFailureTrigger=function(e){window.wpWeixinShareTimelineFailure=new CustomEvent("wpWeixinShareTimelineFailure",{detail:e}),window.dispatchEvent(window.wpWeixinShareTimelineFailure)},window.wpWeixinShareAppMessageSuccessTrigger=function(e){window.wpWeixinShareAppMessageSuccess=new CustomEvent("wpWeixinShareAppMessageSuccess",{detail:e}),window.dispatchEvent(window.wpWeixinShareAppMessageSuccess)},window.wpWeixinShareAppMessageFailureTrigger=function(e){window.wpWeixinShareAppMessageFailure=new CustomEvent("wpWeixinShareAppMessageFailure",{detail:e}),window.dispatchEvent(window.wpWeixinShareAppMessageFailure)},window.wpWeixinShareTimelineSuccessListener=function(i){window.addEventListener("wpWeixinShareTimelineSuccess",function(e){"function"==typeof i&&i(e.detail)})},window.wpWeixinShareTimelineFailureListener=function(i){window.addEventListener("wpWeixinShareTimelineFailure",function(e){"function"==typeof i&&i(e.detail)})},window.wpWeixinShareAppMessageSuccessListener=function(i){window.addEventListener("wpWeixinShareAppMessageSuccess",function(e){"function"==typeof i&&i(e.detail)})},window.wpWeixinShareAppMessageFailureListener=function(i){window.addEventListener("wpWeixinShareAppMessageFailure",function(e){"function"==typeof i&&i(e.detail)})},wx.config({debug:WP_Weixin.debug,appId:WP_Weixin.weixin.appid,timestamp:WP_Weixin.weixin.timestamp,nonceStr:WP_Weixin.weixin.nonceStr,signature:WP_Weixin.weixin.signature,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage","startRecord","stopRecord","onVoiceRecordEnd","playVoice","pauseVoice","stopVoice","onVoicePlayEnd","uploadVoice","downloadVoice","chooseImage","previewImage","uploadImage","downloadImage","translateVoice","getNetworkType","openLocation","getLocation","hideOptionMenu","showOptionMenu","hideMenuItems","showMenuItems","hideAllNonBaseMenuItem","showAllNonBaseMenuItem","closeWindow","scanQRCode","addCard","chooseCard","openCard"]}),wx.ready(function(){o(".wechat-close").on("click",function(e){e.preventDefault(),wx.closeWindow()}),WP_Weixin.share&&(wx.onMenuShareTimeline({title:WP_Weixin.share.title,link:WP_Weixin.share.link,imgUrl:WP_Weixin.share.imgUrl,success:function(){window.wpWeixinShareTimelineSuccessTrigger(WP_Weixin.share)},cancel:function(){window.wpWeixinShareTimelineFailureTrigger(WP_Weixin.share)}}),wx.onMenuShareAppMessage({title:WP_Weixin.share.title,desc:WP_Weixin.share.desc,link:WP_Weixin.share.link,imgUrl:WP_Weixin.share.imgUrl,success:function(){window.wpWeixinShareAppMessageSuccessTrigger(WP_Weixin.share)},cancel:function(){window.wpWeixinShareAppMessageFailureTrigger(WP_Weixin.share)}}))})});